(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-clip-clip~pages-container-container~pages-image-image~pages-index-index~pages-rect-rect~pages-~8af73e39"],{"013f":function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.r(e),n.d(e,"default",function(){return i})},"0293":function(t,e,n){var i=n("241e"),r=n("53e2");n("ce7e")("getPrototypeOf",function(){return function(t){return r(i(t))}})},"061b":function(t,e,n){t.exports=n("fa99")},"1af6":function(t,e,n){var i=n("63b6");i(i.S,"Array",{isArray:n("9003")})},"1df8":function(t,e,n){var i=n("63b6");i(i.S,"Object",{setPrototypeOf:n("ead6").set})},"20fd":function(t,e,n){"use strict";var i=n("d9f6"),r=n("aebd");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},"25b0":function(t,e,n){n("1df8"),t.exports=n("584a").Object.setPrototypeOf},"308d":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return o});var i=n("7618"),r=n("013f");function o(t,e){return!e||"object"!==Object(i["default"])(e)&&"function"!==typeof e?Object(r["default"])(t):e}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"4aa6":function(t,e,n){t.exports=n("dc62")},"4d16":function(t,e,n){t.exports=n("25b0")},"4e2b":function(t,e,n){"use strict";n.r(e);var i=n("4aa6"),r=n.n(i),o=n("4d16"),a=n.n(o);function u(t,e){return u=a.a||function(t,e){return t.__proto__=e,t},u(t,e)}function s(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=r()(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}n.d(e,"default",function(){return s})},"549b":function(t,e,n){"use strict";var i=n("d864"),r=n("63b6"),o=n("241e"),a=n("b0dc"),u=n("3702"),s=n("b447"),h=n("20fd"),c=n("7cd6");r(r.S+r.F*!n("4ee1")(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,l,f=o(t),p="function"==typeof this?this:Array,d=arguments.length,v=d>1?arguments[1]:void 0,y=void 0!==v,x=0,m=c(f);if(y&&(v=i(v,d>2?arguments[2]:void 0,2)),void 0==m||p==Array&&u(m))for(e=s(f.length),n=new p(e);e>x;x++)h(n,x,y?v(f[x],x):f[x]);else for(l=m.call(f),n=new p;!(r=l.next()).done;x++)h(n,x,y?a(l,v,[r.value,x],!0):r.value);return n.length=x,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"5d73":function(t,e,n){t.exports=n("469f")},"6bb5":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return u});var i=n("061b"),r=n.n(i),o=n("4d16"),a=n.n(o);function u(t){return u=a.a?r.a:function(t){return t.__proto__||r()(t)},u(t)}},"6c7b":function(t,e,n){var i=n("5ca1");i(i.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"75fc":function(t,e,n){"use strict";n.r(e);var i=n("a745"),r=n.n(i);function o(t){if(r()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var a=n("774e"),u=n.n(a),s=n("c8bb"),h=n.n(s);function c(t){if(h()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return u()(t)}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return o(t)||c(t)||l()}n.d(e,"default",function(){return f})},"768b":function(t,e,n){"use strict";n.r(e);var i=n("a745"),r=n.n(i);function o(t){if(r()(t))return t}var a=n("5d73"),u=n.n(a);function s(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=u()(t);!(i=(a=s.next()).done);i=!0)if(n.push(a.value),e&&n.length===e)break}catch(h){r=!0,o=h}finally{try{i||null==s["return"]||s["return"]()}finally{if(r)throw o}}return n}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t,e){return o(t)||s(t,e)||h()}n.d(e,"default",function(){return c})},"774e":function(t,e,n){t.exports=n("d2d5")},"7d7b":function(t,e,n){var i=n("e4ae"),r=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},9427:function(t,e,n){var i=n("63b6");i(i.S,"Object",{create:n("a159")})},"95d5":function(t,e,n){var i=n("40c3"),r=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},a745:function(t,e,n){t.exports=n("f410")},b0b4:function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return a});var i=n("85f2"),r=n.n(i);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r()(t,i.key,i)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}},c8bb:function(t,e,n){t.exports=n("54a1")},ce7e:function(t,e,n){var i=n("63b6"),r=n("584a"),o=n("294c");t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},d109:function(t,e,n){"use strict";var i=n("4ea4"),r=i(n("013f")),o=i(n("75fc"));n("5df3"),n("1c4c"),n("6c7b");var a=i(n("768b"));n("28a5"),n("ac6a");var u=i(n("308d")),s=i(n("6bb5")),h=i(n("4e2b"));n("96cf");var c=i(n("d225")),l=i(n("b0b4")),f=i(n("7618"));n("ac4d"),n("8a81"),t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==(0,f.default)(t)&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n.r(e);var i="object"==("undefined"===typeof swan?"undefined":(0,f.default)(swan))?"mp-baidu":"object"==("undefined"===typeof my?"undefined":(0,f.default)(my))?"mp-alipay":"mp-weixin",p=function(){if("undefined"!=typeof uni)return uni;if("undefined"!=typeof wx)return wx;throw new Error("enviroment not support")}(),d=[.296,.313,.436,.638,.586,.89,.87,.256,.334,.334,.455,.742,.241,.433,.241,.427,.586,.586,.586,.586,.586,.586,.586,.586,.586,.586,.241,.241,.742,.742,.742,.483,1.031,.704,.627,.669,.762,.55,.531,.744,.773,.294,.396,.635,.513,.977,.813,.815,.612,.815,.653,.577,.573,.747,.676,1.018,.645,.604,.62,.334,.416,.334,.742,.448,.295,.553,.639,.501,.64,.567,.347,.64,.616,.266,.267,.544,.266,.937,.616,.636,.639,.64,.382,.463,.373,.616,.525,.79,.507,.529,.492,.334,.269,.334,.742,.296],v=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},y=function(){function t(e,n,i){var r,o,a;(0,c.default)(this,t),this.offsetTop=0,this.offsetLeft=0,this.contentHeight=0,this.contentWidth=0,this.painter=e,this.parent=i,this.position=null!=(r=n.position)?r:"static",this.left=null!=(o=n.left)?o:0,this.top=null!=(a=n.top)?a:0}return(0,l.default)(t,[{key:"layout",value:function(){return v(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this._layout();case 2:return e=t.sent,t.abrupt("return",(this.contentHeight=e.height,this.contentWidth=e.width,e));case 4:case"end":return t.stop()}},t,this)}))}},{key:"anchorX",get:function(){var t,e;return null!=(e=null===(t=this.parent)||void 0===t?void 0:t.elementX)?e:0}},{key:"anchorY",get:function(){var t,e;return null!=(e=null===(t=this.parent)||void 0===t?void 0:t.elementY)?e:0}},{key:"elementX",get:function(){switch(this.position){case"absolute":return this.left+this.anchorX;case"static":return this.left+this.offsetLeft+this.anchorX;default:throw new TypeError("unknown position type")}}},{key:"elementY",get:function(){switch(this.position){case"absolute":return this.top+this.anchorY;case"static":return this.top+this.offsetTop+this.anchorY;default:throw new TypeError("unknown position type")}}},{key:"offsetHeight",get:function(){return this.top+this.contentHeight}},{key:"offsetWidth",get:function(){return this.left+this.contentWidth}}]),t}(),x=function(t){function e(t,n){var i;return(0,c.default)(this,e),i=(0,u.default)(this,(0,s.default)(e).call(this,t)),i.option=n,i}return(0,h.default)(e,t),(0,l.default)(e,[{key:"style",get:function(){var t=this.painter,e=t.ctx,n=t.upx2px,i=this.option,r=i.x1,o=i.x2,a=i.y1,u=i.y2,s=e.createLinearGradient(n(this.element.elementX+r),n(this.element.elementY+a),n(this.element.elementX+o),n(this.element.elementY+u));return this.option.colorStops.forEach(function(t){s.addColorStop(t.offset,t.color)}),s}}]),e}(function(){function t(e){(0,c.default)(this,t),this.element=e}return(0,l.default)(t,[{key:"painter",get:function(){return this.element.painter}}]),t}());function m(t,e){if("string"==typeof e)return e;switch(e.type){case"liner-gradient":return new x(t,e).style;default:throw new Error("Unkwon option type")}}var w=function(t){function e(t,n,i){var r,o,a,h,l,f,p,d,v,y;return(0,c.default)(this,e),r=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),r.option={color:(o=n.color,null!=o?o:"#000"),align:(a=n.align,null!=a?a:"left"),fontWeight:(h=n.fontWeight,null!=h?h:"normal"),fontStyle:(l=n.fontStyle,null!=l?l:"normal"),fontFamily:(f=n.fontFamily,null!=f?f:"serial"),fontSize:(p=n.fontSize,null!=p?p:30),baseline:(d=n.baseline,null!=d?d:"top"),content:(v=n.content,null!=v?v:""),width:(y=n.width,null!=y?y:void 0)},r}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){var t;return{width:null!=(t=this.option.width)?t:this.painter.measureText(this.option.content,this.option.fontSize),height:this.option.fontSize}}},{key:"paint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.inTextBlock,n=void 0!==e&&e;this.painter.ctx.font=["normal"!=this.option.fontWeight&&this.option.fontWeight,"normal"!=this.option.fontStyle&&this.option.fontStyle,this.painter.upx2px(this.option.fontSize)+"px",this.option.fontFamily].filter(Boolean).join(" "),n||this.painter.setFillStyle(m(this,this.option.color)),this.painter.ctx.setFontSize(this.painter.upx2px(this.option.fontSize)),this.painter.ctx.setTextBaseline(this.option.baseline),this.painter.ctx.setTextAlign(this.option.align),this.painter.ctx.fillText(this.option.content,this.painter.upx2px(this.elementX),this.painter.upx2px(this.elementY))}}]),e}(y),g=function(){function t(e){(0,c.default)(this,t),this.fontSize=e.fontSize,this.lineClamp=e.lineClamp||1/0,this.width=e.width,this.ctx=e.painter.ctx,this.painter=e.painter,this.content=e.content,this.lines=[],this.currentLineText="",this.position=0,this.endPostion=this.position,this.isOverflow=!1,this.isDry=!1,this.isFull=!1}return(0,l.default)(t,[{key:"split",value:function(){return this.ctx.setFontSize(this.fontSize),this.fillText(),this.lines}},{key:"minCharNumberInWidth",value:function(t){return Math.ceil(t/this.fontSize)}},{key:"freeSpaceInCurrentLine",value:function(){if(this.currentLineText.length){var t=this.painter.measureText(this.currentLineText,this.fontSize);return this.width-(t||0)}return this.width}},{key:"adjustCharNumberInCurrentLine",value:function(t){var e=this.currentLineText.length+t,n=this.content.length;e=Math.min(e,n),this.isDry=e==n,this.currentLineText=this.content.slice(0,e)}},{key:"commitLine",value:function(){this.content=this.content.slice(this.currentLineText.length),this.lines.push(this.currentLineText),this.currentLineText="",this.lines.length==this.lineClamp&&(this.isFull=!0,0==this.isDry&&(this.isOverflow=!0))}},{key:"handleOverflow",value:function(){var t=this.lines.pop();t=t.substring(0,Math.max(0,t.length-1))+"...",this.lines.push(t)}},{key:"fillText",value:function(){var t=this.freeSpaceInCurrentLine();if(t<=0){if(this.adjustCharNumberInCurrentLine(-1),this.commitLine(),this.isOverflow&&this.handleOverflow(),this.isFull)return;t=this.freeSpaceInCurrentLine()}else if(this.isDry)return void this.commitLine();var e=this.minCharNumberInWidth(t);this.adjustCharNumberInCurrentLine(e),this.fillText()}}]),t}(),b=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},k=function(t){function e(t,n,i){var r,o,a,h,l,f,p,d;return(0,c.default)(this,e),r=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),r.option=Object.assign(Object.assign({},n),{width:(o=n.width,null!=o?o:100),height:(a=n.height,null!=a?a:"auto"),fontSize:(h=n.fontSize,null!=h?h:30),content:(l=n.content,null!=l?l:""),lineHeight:(f=n.lineHeight,null!=f?f:40),lineClamp:(p=n.lineClamp,null!=p?p:0),color:(d=n.color,null!=d?d:"black")}),r.lines=[],r}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return this.lines=new g({fontSize:this.option.fontSize,lineClamp:this.option.lineClamp,width:this.option.width,painter:this.painter,content:this.option.content}).split(),{width:this.option.width,height:"auto"==this.option.height?(this.lines.length-1)*this.option.lineHeight+this.option.fontSize:this.option.height}}},{key:"paint",value:function(){return b(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.painter.setFillStyle(m(this,this.option.color)),this.lines.map(function(t,n){var i=Object.assign(Object.assign({},e.option),{type:"text",top:e.elementY+n*e.option.lineHeight,left:e.elementX,position:e.position,content:t});new w(e.painter,i).paint({inTextBlock:!0})});case 1:case"end":return t.stop()}},t,this)}))}}]),e}(y),S=function(){var t;if("function"==typeof p.upx2px)return p.upx2px;var e=(null!=(t=p.getSystemInfoSync().screenWidth)?t:375)/750;return function(t){return t*e}}(),T=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},O=function(t){var e=Object.create(null);return function(n){return n in e||(e[n]=t(n)),e[n]}}(function(t){return T(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,i,r,o,a,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(u=uni.getImageInfo,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(e,n){t.success=e,t.fail=n,u(t)})})({src:t});case 3:return n=e.sent,i=n.width,r=void 0===i?100:i,o=n.height,a=void 0===o?100:o,e.abrupt("return",{width:r,height:a});case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",(console.log("mp-painter:getImageOriginSize: fail, use default size: width = 100, height = 100"),{width:100,height:100}));case 14:case"end":return e.stop()}},e,null,[[0,11]])}))}),j=function(t){function e(t,n,i){var r,o,a,h,l;return(0,c.default)(this,e),r=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),r.option={width:(o=n.width,null!=o?o:100),height:(a=n.height,null!=a?a:100),objectFit:(h=n.objectFit,null!=h?h:"fill"),objectPosition:(l=n.objectPosition,null!=l?l:["center","center"]),src:n.src},r}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return{width:this.option.width,height:this.option.height}}},{key:"paint",value:function(){return T(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,i,r,o,u,s,h,c,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.option.src){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,function(t,e){return T(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.platform,!(/^\./.test(e.src)||/^\/static/.test(e.src)||/^data:image\//.test(e.src)||"mp-alipay"==i&&/^https:\/\/resource\//.test(e.src)||"mp-weixin"==i&&/^wxfile:/.test(e.src)||"mp-baidu"==i&&/^bdfile:\/\/tmp/.test(e.src))){n.next=5;break}n.t0=e.src,n.next=9;break;case 5:return console.log("mp-painter:绘制图片: 下载图片文件:",e.src),n.next=8,(r=e.src,new Promise(function(t,e){return p.downloadFile({url:r,success:function(e){return t(e.tempFilePath)},fail:e})})).catch(function(t){return console.log("mp-painter:下载错误: ",t),""});case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))}(this.painter,this.option);case 4:if(e=t.sent,!e){t.next=26;break}if(console.log("mp-painter:调用小程序drawImage，使用:",e),"fill"==this.option.objectFit){t.next=25;break}return t.t0=function(t,e,n){var i,r,o=e.width/e.height,u=n.width/n.height,s=1;if(o>u&&"contain"==t.objectFit||o<=u&&"cover"==t.objectFit)s=n.width/e.width;else{if(!(o>u&&"cover"==t.objectFit||o<=u&&"contain"==t.objectFit))throw new Error("Unkonwn concreteScale");s=n.height/e.height}var h=e.width*s,c=e.height*s,l={left:0,center:.5,right:1}[(null===(i=t.objectPosition)||void 0===i?void 0:i[0])||"center"],f={top:0,center:.5,bottom:1}[(null===(r=t.objectPosition)||void 0===r?void 0:r[1])||"center"],p=(n.width-h)*l,d=(n.height-c)*f,v=function(t,e){return[(t-p)/s,(e-d)/s]},y=v(0,0),x=(0,a.default)(y,2),m=x[0],w=x[1],g=v(n.width,n.height),b=(0,a.default)(g,2),k=b[0],S=b[1];return{sx:Math.max(m,0),sy:Math.max(w,0),sw:Math.min(k-m,e.width),sh:Math.min(S-w,e.height),dx:Math.max(p,0),dy:Math.max(d,0),dw:Math.min(h,n.width),dh:Math.min(c,n.height)}},t.t1={objectFit:this.option.objectFit,objectPosition:this.option.objectPosition},t.next=11,O(e);case 11:t.t2=t.sent,t.t3={width:this.option.width,height:this.option.height},n=(0,t.t0)(t.t1,t.t2,t.t3),i=n.sx,r=n.sy,o=n.sh,u=n.sw,s=n.dx,h=n.dy,c=n.dh,l=n.dw,this.painter.ctx.drawImage(e,i,r,u,o,S(s+this.elementX),S(h+this.elementY),S(l),S(c)),t.next=26;break;case 25:this.painter.ctx.drawImage(e,S(this.elementX),S(this.elementY),S(this.option.width),S(this.option.height));case 26:case"end":return t.stop()}},t,this)}))}}]),e}(y),R=function(t){function e(t,n,i){var r,o,a,h,l,f;return(0,c.default)(this,e),r=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),r.option={dx:(o=n.dx,null!=o?o:0),dy:(a=n.dy,null!=a?a:0),color:(h=n.color,null!=h?h:"#000"),dashPattern:(l=n.dashPattern,null!=l?l:[1,0]),lineWidth:(f=n.lineWidth,null!=f?f:1)},r}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return{width:this.option.dx,height:this.option.dy}}},{key:"paint",value:function(){var t=this,e=this.painter.upx2px(this.elementX),n=this.painter.upx2px(this.elementY),i=this.painter.upx2px(this.elementX+this.option.dx),r=this.painter.upx2px(this.elementY+this.option.dy);this.painter.ctx.beginPath(),this.painter.ctx.moveTo(e,n),this.painter.ctx.lineTo(i,r),this.painter.ctx.setLineDash(this.option.dashPattern.map(function(e){return t.painter.upx2px(e)})),this.painter.setStrokeStyle(m(this,this.option.color)),this.painter.ctx.lineWidth=this.painter.upx2px(this.option.lineWidth),this.painter.ctx.stroke()}}]),e}(y),P=function(t){function e(t,n){var i;return(0,c.default)(this,e),i=(0,u.default)(this,(0,s.default)(e).call(this,t,n)),i.option=n,i.option.borderRadius&&i.assertBorderRadius(),i}return(0,h.default)(e,t),(0,l.default)(e,[{key:"assertBorderRadius",value:function(){this.normalizedBorderRadius.some(function(t){return t<0})&&(console.warn("border radius must greater than 0, got:",this.normalizedBorderRadius.join(",")),this.option.borderRadius=0)}},{key:"paint",value:function(){this.reduceBorderRadius();var t=(0,a.default)(this.normalizedBorderRadius,4),e=t[0],n=t[1],i=t[2],r=t[3],o=this.painter,u=o.ctx,s=o.upx2px;u.beginPath(),u.moveTo(s(this.pathX),s(this.pathY+e)),this.painter.arcTo(s(this.pathX),s(this.pathY),s(this.pathX+e),s(this.pathY),s(e)),this.painter.arcTo(s(this.pathX+this.option.width),s(this.pathY),s(this.pathX+this.option.width),s(this.pathY+n),s(n)),this.painter.arcTo(s(this.pathX+this.option.width),s(this.pathY+this.option.height),s(this.pathX+this.option.width-i),s(this.pathY+this.option.height),s(i)),this.painter.arcTo(s(this.pathX),s(this.pathY+this.option.height),s(this.pathX),s(this.pathY+this.option.height-r),s(r)),u.closePath()}},{key:"reduceBorderRadius",value:function(){var t=(0,a.default)(this.normalizedBorderRadius,4),e=t[0],n=t[1],i=t[2],r=t[3],o=Math.min(this.option.width/(e+n),this.option.height/(n+i),this.option.width/(r+i),this.option.height/(e+r));o>=1||(this.option.borderRadius=this.normalizedBorderRadius.map(function(t){return t*o}))}},{key:"normalizedBorderRadius",get:function(){return"number"==typeof this.option.borderRadius?Array.from({length:4}).fill(this.option.borderRadius):(0,o.default)(this.option.borderRadius)}}]),e}(function(){function t(e,n){var i,r;(0,c.default)(this,t),this.element=e,this.left=null!=(i=n.left)?i:0,this.top=null!=(r=n.top)?r:0}return(0,l.default)(t,[{key:"painter",get:function(){return this.element.painter}},{key:"pathX",get:function(){return this.element.elementX+this.left}},{key:"pathY",get:function(){return this.element.elementY+this.top}}]),t}());function _(t,e){switch(e.type){case"rounded-rect":return new P(t,e);default:throw new Error("Unkwon option type")}}var F=function(t){function e(t,n,i){var r,o,a,h,l,f,p,d;return(0,c.default)(this,e),r=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),r.option={width:(o=n.width,null!=o?o:100),height:(a=n.height,null!=a?a:100),borderRadius:(h=n.borderRadius,null!=h?h:0),background:(l=n.background,null!=l?l:"transparent"),borderStyle:(f=n.borderStyle,null!=f?f:"solid"),borderWidth:(p=n.borderWidth,null!=p?p:0),borderColor:(d=n.borderColor,null!=d?d:"#000")},r}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return{width:this.option.width,height:this.option.height}}},{key:"paint",value:function(){(this.shouldFill||this.shouldStroke)&&(this.option.borderRadius?this.paintByPath():this.paintByRect())}},{key:"applyFillStyle",value:function(){this.painter.setFillStyle(m(this,this.option.background))}},{key:"applyStrokeStyle",value:function(){var t,e;this.painter.ctx.setLineDash((t=this.option.borderStyle,{dashed:[e=this.option.borderWidth,e],solid:[10,0]}[t])),this.painter.ctx.lineWidth=this.painter.upx2px(this.option.borderWidth),this.painter.setStrokeStyle(this.option.borderColor)}},{key:"paintByRect",value:function(){var t,e,n=[this.painter.upx2px(this.elementX),this.painter.upx2px(this.elementY),this.painter.upx2px(this.option.width),this.painter.upx2px(this.option.height)];this.shouldFill&&(this.applyFillStyle(),(t=this.painter.ctx).fillRect.apply(t,n)),this.shouldStroke&&(this.applyStrokeStyle(),(e=this.painter.ctx).strokeRect.apply(e,n))}},{key:"paintByPath",value:function(){_(this,{type:"rounded-rect",height:this.option.height,width:this.option.width,borderRadius:this.option.borderRadius}).paint(),this.shouldFill&&(this.painter.setFillStyle(m(this,this.option.background)),this.painter.ctx.fill()),this.shouldStroke&&(this.applyStrokeStyle(),this.painter.ctx.stroke())}},{key:"shouldFill",get:function(){return"trasparent"!==this.option.background}},{key:"shouldStroke",get:function(){return this.option.borderWidth>0}}]),e}(y),C=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},z=function(t){function e(t,n,i){var o,a,h,l,f;return(0,c.default)(this,e),o=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),o.childOffsetTop=0,o.childOffsetLeft=0,o.option={direction:(a=n.direction,null!=a?a:"vertical"),width:(h=n.width,null!=h?h:"auto"),height:(l=n.height,null!=l?l:"auto"),children:(f=n.children,null!=f?f:[])},o.children=o.option.children.map(function(t){return E(o.painter,t,(0,r.default)(o))}),o}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return C(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.layoutChildren();case 2:return t.abrupt("return",{width:this.calcContainerWidth(),height:this.calcContainerHeight()});case 3:case"end":return t.stop()}},t,this)}))}},{key:"layoutChildren",value:function(){return C(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,i,r,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,i=void 0,t.prev=3,r=this.children[Symbol.iterator]();case 5:if(e=(o=r.next()).done){t.next=12;break}return a=o.value,t.next=9,this.layoutChild(a);case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),n=!0,i=t.t0;case 18:t.prev=18,t.prev=19,e||null==r.return||r.return();case 21:if(t.prev=21,!n){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])}))}},{key:"layoutChild",value:function(t){return C(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.layout();case 2:"absolute"!=t.position&&("vertical"==this.option.direction?(t.offsetTop=this.childOffsetTop,this.childOffsetTop+=t.offsetHeight):(t.offsetLeft=this.childOffsetLeft,this.childOffsetLeft+=t.offsetWidth));case 3:case"end":return e.stop()}},e,this)}))}},{key:"calcContainerWidth",value:function(){if("number"==typeof this.option.width)return this.option.width;switch(this.option.direction){case"vertical":return this.childrenMaxWidth();case"horizontal":return this.childOffsetLeft;default:throw new TypeError("Unknown direction")}}},{key:"calcContainerHeight",value:function(){if("number"==typeof this.option.height)return this.option.height;switch(this.option.direction){case"vertical":return this.childOffsetTop;case"horizontal":return this.childrenMaxHeight();default:throw new TypeError("Unknown direction")}}},{key:"paint",value:function(){return C(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,i,r,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,i=void 0,t.prev=3,r=this.children[Symbol.iterator]();case 5:if(e=(o=r.next()).done){t.next=12;break}return a=o.value,t.next=9,a.paint();case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),n=!0,i=t.t0;case 18:t.prev=18,t.prev=19,e||null==r.return||r.return();case 21:if(t.prev=21,!n){t.next=24;break}throw i;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])}))}},{key:"childrenMaxWidth",value:function(){return Math.max.apply(Math,(0,o.default)(this.children.map(function(t){return t.offsetWidth})))}},{key:"childrenMaxHeight",value:function(){return Math.max.apply(Math,(0,o.default)(this.children.map(function(t){return t.offsetHeight})))}}]),e}(y),W=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},X=function(t){function e(t,n,i){var o;return(0,c.default)(this,e),o=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),o.contentElement=E(t,n.content,(0,r.default)(o)),o.clipPath=_((0,r.default)(o),n.path),o}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return this.contentElement.layout()}},{key:"paint",value:function(){return W(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.painter.ctx.save(),t.next=3,this.clipPath.paint();case 3:return this.painter.ctx.clip(),t.next=6,this.contentElement.paint();case 6:this.painter.ctx.restore();case 7:case"end":return t.stop()}},t,this)}))}}]),e}(y),Y=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},L=function(t){function e(t,n,i){var o,a,h;return(0,c.default)(this,e),o=(0,u.default)(this,(0,s.default)(e).call(this,t,n,i)),o.contentElement=E(t,n.content,(0,r.default)(o)),o.transformOptions=null!=(a=n.transform)?a:[],o.transformOrigin=null!=(h=n.transformOrigin)?h:["center","center"],o}return(0,h.default)(e,t),(0,l.default)(e,[{key:"_layout",value:function(){return this.contentElement.layout()}},{key:"paint",value:function(){return Y(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.painter.ctx.save(),this.withTransformOrigin(function(){return e.transform()}),t.next=4,this.contentElement.paint();case 4:this.painter.ctx.restore();case 5:case"end":return t.stop()}},t,this)}))}},{key:"transform",value:function(){var t=this;this.transformOptions.forEach(function(e){return t.singleTransform(e)})}},{key:"singleTransform",value:function(t){var e,n,i,r;switch(t.type){case"translate":return this.painter.ctx.translate(this.painter.upx2px(null!=(e=t.x)?e:0),this.painter.upx2px(null!=(n=t.y)?n:0));case"rotate":return this.painter.ctx.rotate(t.rotate/180*Math.PI);case"scale":return this.painter.ctx.scale(null!=(i=t.scaleWidth)?i:1,null!=(r=t.scaleHeight)?r:1);case"set-matrix":return this.painter.ctx.setTransform(t.scaleX,t.skewX,t.scaleY,t.scaleY,this.painter.upx2px(t.translateX),this.painter.upx2px(t.translateY));default:throw new Error("Unknown transform type.")}}},{key:"withTransformOrigin",value:function(t){var e={x:this.elementX+this.contentWidth*{left:0,center:.5,right:1}[this.transformOrigin[0]],y:this.elementY+this.contentHeight*{top:0,center:.5,bottom:1}[this.transformOrigin[1]]};this.singleTransform({type:"translate",x:e.x,y:e.y}),t(),this.singleTransform({type:"translate",x:-e.x,y:-e.y})}}]),e}(y);function E(t,e,n){switch(e.type){case"text":return new w(t,e,n);case"text-block":return new k(t,e,n);case"image":return new j(t,e,n);case"line":return new R(t,e,n);case"rect":return new F(t,e,n);case"container":return new z(t,e,n);case"clip":return new X(t,e,n);case"transform":return new L(t,e,n);default:throw new TypeError("Unkown painter element type")}}n.d(e,"default",function(){return I});var M=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((i=i.apply(t,e||[])).next())})},I=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.platform,o=void 0===r?i:r,a=n.upx2px;(0,c.default)(this,t),this.ctx=e,this.platform=o,this.upx2px=null!=a?a:S,"mp-alipay"==o&&(this.upx2px=function(t){return(null!=a?a:S)(2*t)})}return(0,l.default)(t,[{key:"draw",value:function(t){return M(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._drawObj(t);case 2:return n=e.sent,e.next=5,new Promise(function(t){return i.ctx.draw(!0,t)});case 5:return e.next=7,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(e){return setTimeout(e,t)})}(100);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}))}},{key:"_drawObj",value:function(t){return M(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=E(this,t),e.next=3,n.layout();case 3:return i=e.sent,e.next=6,n.paint();case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}))}},{key:"setFillStyle",value:function(t){"mp-baidu"==this.platform?this.ctx.setFillStyle(t):this.ctx.fillStyle=t}},{key:"setStrokeStyle",value:function(t){"mp-baidu"==this.platform?this.ctx.setStrokeStyle(t):this.ctx.strokeStyle=t}},{key:"measureText",value:function(t,e){if("mp-baidu"==this.platform){var n=this.ctx.measureText(t).width;if(n)return n/10*e}else{if("mp-alipay"==this.platform)return t.split("").reduce(function(t,e){var n=e.charCodeAt(0);return t+(d[n-32]||1)},0)*e;this.ctx.setFontSize(e);var i=this.ctx.measureText(t).width;if(i)return i}return t.length*e}},{key:"arcTo",value:function(t,e,n,i,r){return r<2?this.ctx.lineTo(t,e):this.ctx.arcTo(t,e,n,i,r)}}]),t}()}])},d225:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.r(e),n.d(e,"default",function(){return i})},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},dc62:function(t,e,n){n("9427");var i=n("584a").Object;t.exports=function(t,e){return i.create(t,e)}},ead6:function(t,e,n){var i=n("f772"),r=n("e4ae"),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("d864")(Function.call,n("bf0b").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},fa99:function(t,e,n){n("0293"),t.exports=n("584a").Object.getPrototypeOf}}]);